<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dilema do Inovador - Teoria dos Jogos</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8f9fa;
            --text-primary: #1E3A8A; /* Azul Hawking */
            --text-secondary: #6B7280;
            --accent-gold: #D4AF37; /* Ouro Da Vinci */
            --accent-blue: #1E3A8A;
            --border: #e5e7eb;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #ffffff;
            --text-secondary: #94a3b8;
            --border: #334155;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            margin: 0;
            padding: 20px;
            transition: background 0.3s, color 0.3s;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            align-items: start;
        }
        .header {
            grid-column: 1 / -1;
            text-align: center;
            margin-bottom: 20px;
        }
        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--accent-gold);
            color: var(--text-primary);
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 18px;
            transition: background 0.3s;
        }
        .theme-toggle:hover {
            background: var(--accent-blue);
            color: white;
        }
        .matrix {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
        }
        .matrix h2 {
            margin-top: 0;
            color: var(--accent-gold);
        }
        .payoff-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .payoff {
            background: white;
            border: 1px solid var(--border);
            padding: 15px;
            border-radius: 5px;
            transition: all 0.3s;
            cursor: pointer;
            [data-theme="dark"] & { background: var(--bg-secondary); }
        }
        .payoff:hover, .payoff.selected {
            background: var(--accent-gold);
            color: white;
            transform: scale(1.05);
        }
        .payoff.society-choice {
            background: var(--accent-blue);
            color: white;
        }
        .controls {
            grid-column: 1 / -1;
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: var(--accent-gold);
            color: var(--text-primary);
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        button:hover {
            background: var(--accent-blue);
            color: white;
        }
        .mode-select {
            margin: 10px;
        }
        #chartContainer {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        .history {
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            box-shadow: var(--shadow);
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid var(--border);
            padding: 8px;
            text-align: center;
        }
        th {
            background: var(--accent-gold);
            color: white;
        }
        .explanation {
            grid-column: 1 / -1;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        .explanation h3 {
            color: var(--accent-gold);
        }
        @media (max-width: 768px) {
            .container { grid-template-columns: 1fr; }
            .payoff-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">üåô</button>
    <div class="header">
        <h1>Dilema do Inovador</h1>
        <p>Teoria dos Jogos: Escolha entre Compartilhar (coopera√ß√£o) ou Guardar (defeito) sua inova√ß√£o. A Sociedade responde. Objetivo: Maximizar seu payoff ao longo de rodadas.</p>
        <p>Score Atual: Inovador <span id="innovatorScore">0</span> | Sociedade <span id="societyScore">0</span></p>
    </div>
    <div class="container">
        <div class="matrix">
            <h2>Matriz de Payoffs (Inovador vs Sociedade)</h2>
            <div class="payoff-grid">
                <div class="payoff" onclick="selectChoice('share', 'share')">Compartilhar / Compartilhar<br>(3, 3)</div>
                <div class="payoff" onclick="selectChoice('share', 'keep')">Compartilhar / Guardar<br>(0, 5)</div>
                <div class="payoff" onclick="selectChoice('keep', 'share')">Guardar / Compartilhar<br>(5, 0)</div>
                <div class="payoff" onclick="selectChoice('keep', 'keep')">Guardar / Guardar<br>(1, 1)</div>
            </div>
            <p><em>Clique em uma c√©lula para escolher sua a√ß√£o (Compartilhar ou Guardar). A Sociedade responde com base no modo.</em></p>
        </div>
        <div class="controls">
            <h3>Controles</h3>
            <select id="mode" class="mode-select" onchange="setMode()">
                <option value="manual">Modo Manual (Escolha resposta da Sociedade)</option>
                <option value="random">Modo Aleat√≥rio (Sociedade escolhe random)</option>
            </select>
            <br>
            <button onclick="playRound()">Jogar Rodada</button>
            <button onclick="resetGame()">Resetar Jogo</button>
            <div id="manualControls" style="display: none;">
                <button onclick="societyChoice('share')">Sociedade: Compartilhar</button>
                <button onclick="societyChoice('keep')">Sociedade: Guardar</button>
            </div>
        </div>
        <div id="chartContainer">
            <canvas id="payoffChart"></canvas>
        </div>
        <div class="history">
            <h3>Hist√≥rico de Rodadas</h3>
            <table id="historyTable">
                <thead>
                    <tr><th>Rodada</th><th>Sua Escolha</th><th>Escolha Sociedade</th><th>Payoff Inovador</th><th>Payoff Sociedade</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="explanation">
            <h3>Explica√ß√£o: Equil√≠brio de Nash</h3>
            <p>No **Dilema do Prisioneiro** (adaptado aqui para inova√ß√£o), o Equil√≠brio de Nash ocorre quando ambos escolhem "Guardar" (1,1), pois √© a estrat√©gia dominante ‚Äî independentemente da outra parte, maximiza o payoff individual. No entanto, ambos "Compartilharem" (3,3) seria √≥timo coletivo, mas inst√°vel. Isso ilustra o conflito entre racionalidade individual e coletiva em teoria dos jogos. Payoffs baseados em unidades convencionais: coopera√ß√£o m√∫tua beneficia todos, mas defeito explora.</p>
            <p><strong>Estrat√©gia de longo prazo:</strong> Em rodadas repetidas (como este jogo), estrat√©gias como "Tit-for-Tat" (copiar a a√ß√£o anterior da Sociedade) podem emergir para coopera√ß√£o sustent√°vel, evitando o Nash puro.</p>
        </div>
    </div>

    <script>
        let innovatorScore = 0;
        let societyScore = 0;
        let rounds = [];
        let playerChoice = null;
        let societyChoice = null;
        let mode = 'manual';
        let chart;

        const payoffs = {
            share_share: [3, 3],
            share_keep: [0, 5],
            keep_share: [5, 0],
            keep_keep: [1, 1]
        };

        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            body.setAttribute('data-theme', newTheme);
            document.querySelector('.theme-toggle').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            localStorage.setItem('theme', newTheme);
        }

        // Carrega tema salvo
        window.onload = () => {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            document.querySelector('.theme-toggle').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            initChart();
        };

        function selectChoice(player, society) {
            playerChoice = player;
            societyChoice = society;
            document.querySelectorAll('.payoff').forEach(cell => cell.classList.remove('selected', 'society-choice'));
            const selector = `.payoff[onclick="selectChoice('${player}', '${society}')"]`;
            document.querySelector(selector).classList.add('selected');
            if (mode === 'manual') {
                document.getElementById('manualControls').style.display = 'block';
            }
        }

        function setMode() {
            mode = document.getElementById('mode').value;
            document.getElementById('manualControls').style.display = mode === 'manual' ? 'block' : 'none';
            if (mode === 'random' && playerChoice) {
                societyChoice = Math.random() < 0.5 ? 'share' : 'keep';
                updateSocietyHighlight();
            }
        }

        function societyChoice(choice) {
            societyChoice = choice;
            updateSocietyHighlight();
        }

        function updateSocietyHighlight() {
            if (societyChoice && playerChoice) {
                const selector = `.payoff[onclick="selectChoice('${playerChoice}', '${societyChoice}')"]`;
                document.querySelector(selector).classList.add('society-choice');
            }
        }

        function playRound() {
            if (!playerChoice || !societyChoice) {
                alert('Selecione sua escolha e a da Sociedade (ou ative modo aleat√≥rio)!');
                return;
            }
            const key = `${playerChoice}_${societyChoice}`;
            const [innovatorPayoff, societyPayoff] = payoffs[key];
            innovatorScore += innovatorPayoff;
            societyScore += societyPayoff;
            rounds.push({ round: rounds.length + 1, player: playerChoice, society: societyChoice, innovator: innovatorPayoff, society: societyPayoff });

            document.getElementById('innovatorScore').textContent = innovatorScore;
            document.getElementById('societyScore').textContent = societyScore;
            updateHistory();
            updateChart();
            clearSelection();
        }

        function clearSelection() {
            playerChoice = null;
            societyChoice = null;
            document.querySelectorAll('.payoff').forEach(cell => cell.classList.remove('selected', 'society-choice'));
            if (mode === 'random') {
                societyChoice = null; // Reset para pr√≥xima
            }
        }

        function updateHistory() {
            const tbody = document.querySelector('#historyTable tbody');
            tbody.innerHTML = '';
            rounds.forEach(r => {
                const row = tbody.insertRow();
                row.innerHTML = `<td>${r.round}</td><td>${r.player.charAt(0).toUpperCase() + r.player.slice(1)}</td><td>${r.society.charAt(0).toUpperCase() + r.society.slice(1)}</td><td>${r.innovator}</td><td>${r.society}</td>`;
            });
        }

        function initChart() {
            const ctx = document.getElementById('payoffChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [
                        { label: 'Inovador (Ouro)', data: [], borderColor: '#D4AF37', backgroundColor: 'rgba(212, 175, 55, 0.2)', tension: 0.1 },
                        { label: 'Sociedade (Azul)', data: [], borderColor: '#1E3A8A', backgroundColor: 'rgba(30, 58, 138, 0.2)', tension: 0.1 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: true } }
                }
            });
        }

        function updateChart() {
            const innovatorCum = rounds.map(r => r.innovator).reduce((a, b) => a + b, 0);
            const societyCum = rounds.map(r => r.society).reduce((a, b) => a + b, 0);
            chart.data.labels = rounds.map(r => `Rodada ${r.round}`);
            chart.data.datasets[0].data = rounds.map((r, i) => rounds.slice(0, i+1).reduce((sum, rr) => sum + rr.innovator, 0));
            chart.data.datasets[1].data = rounds.map((r, i) => rounds.slice(0, i+1).reduce((sum, rr) => sum + rr.society, 0));
            chart.update();
        }

        function resetGame() {
            innovatorScore = 0;
            societyScore = 0;
            rounds = [];
            document.getElementById('innovatorScore').textContent = 0;
            document.getElementById('societyScore').textContent = 0;
            updateHistory();
            updateChart();
            clearSelection();
        }
    </script>
</body>
</html>
